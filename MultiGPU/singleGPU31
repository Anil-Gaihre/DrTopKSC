jsrun --nrs 1 --tasks_per_rs 1 --cpu_per_rs 1 --gpu_per_rs 1 --rs_per_host 1 ./topk.bin 31 128 8 2 1
setting up GPU: 0
./exe num_element k NBitsPerDigit beta NGPU
Size of unsigned int4
num_element: 2147483648
NIterationPerGPU: 2
Calculated alpha: 13
final_num_pow: 30
SubRangesize: 8192
Minimum value:3
Data generated not Ok
final_num_pow: 30
Final number of element: 1073741824
Number of Subranges:131072
Starting TopK with Npow:31 K:128 alpha:13DistributionU(0,2^31-1)
1804289383
Size of shared memory per block:33KB
Starting iteration: 0
Num_element: 1073741824
Process: 0 finished sampling!


Inside InPlace Radix Select(Phase II)
Number of elements131072
Current Digit:3

KDigit127
BelowCount:0
Kcount:131072
Current Digit:2

KDigit255
BelowCount:102021
Kcount:29051
Current Digit:1

KDigit254
BelowCount:130842
Kcount:115
Current Digit:0

KDigit218
BelowCount:130944
Kcount:1
Number of subranges in first sweep:127
Total time of radix_select Inplace_firstTopk(Phase II):0.329971 ms
Process: 0 new Concatenated Size: 128
Process: 0 top-k after concatenation: 2147483354
Time for concatenation:0.127077 ms
The concatenation of the contributing subranges is done!


Inside InPlace Radix Select(Phase II)
Number of elements128
Current Digit:3

KDigit127
BelowCount:0
Kcount:128
Current Digit:2

KDigit255
BelowCount:0
Kcount:128
Current Digit:1

KDigit254
BelowCount:0
Kcount:13
Current Digit:0

KDigit218
BelowCount:0
Kcount:1
Total time of radix_select Inplace(Phase II):0.231981 ms
Process: 0 top-k after immediate second top-k: 2147483354
Starting iteration: 1
Num_element: 1073741824
Process: 0 finished sampling!


Inside InPlace Radix Select(Phase II)
Number of elements131072
Current Digit:3

KDigit0
BelowCount:0
Kcount:131072
Current Digit:2

KDigit0
BelowCount:0
Kcount:131071
Current Digit:1

KDigit0
BelowCount:0
Kcount:131071
Current Digit:0

KDigit0
BelowCount:0
Kcount:131071
Number of subranges in first sweep:1
Total time of radix_select Inplace_firstTopk(Phase II):0.319004 ms
Process: 0 new Concatenated Size: 1048576
Process: 0 top-k after concatenation: 0
Time for concatenation:0.197172 ms
The concatenation of the contributing subranges is done!


Inside InPlace Radix Select(Phase II)
Number of elements1048576
Current Digit:3

KDigit0
BelowCount:0
Kcount:1048576
Current Digit:2

KDigit0
BelowCount:0
Kcount:1048576
Current Digit:1

KDigit59
BelowCount:1048416
Kcount:96
Current Digit:0

KDigit160
BelowCount:1048448
Kcount:1
Total time of radix_select Inplace(Phase II):0.311136 ms
Process: 0 top-k after immediate second top-k: 15264
Final number of elements after reduction to Process 0: 256


Inside InPlace Radix Select(Phase II)
Number of elements256
Current Digit:3

KDigit127
BelowCount:128
Kcount:128
Current Digit:2

KDigit255
BelowCount:128
Kcount:128
Current Digit:1

KDigit254
BelowCount:128
Kcount:13
Current Digit:0

KDigit218
BelowCount:128
Kcount:1
Total time of radix_select Inplace(Phase II):0.231028 ms
The kth element from top is:2147483354
Process: 0 Sampling Time: 4.84204 ms
Process: 0 Time for First TopK: 0.330925 ms
Process: 0 Time for sampling and First TopK: 5.20492 ms

Process: 0 Time for Concatenation:0.197172 ms
Process: 0 Time for Second TopK: 0.32711 ms
Process: 0 Time for Concatenation and Second TopK: 0.597 ms

Process: 0 Time for communicating FirstTopkAndSecondTopk: 0 ms

Process: 0 Time for Find and Fill: 0.0469685 ms

Process: 0 Time for Offset gather: 0 ms

Process: 0 Time for Communication and Final TopK(in P0): 0.00905991 ms
Process: 0 Total Time:11.8802 ms
The total global time for top-k computation: 11.8802 ms

Not Success!
Required value2147483504
